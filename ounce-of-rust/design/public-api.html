
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>4.1. Public API &#8212; Ounce of Rust Project Design Document Rev. A draft 1</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4.2. Artificial Intelligence Algorithms" href="ai-algorithms.html" />
    <link rel="prev" title="4. Design" href="index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="public-api">
<h1>4.1. Public API<a class="headerlink" href="#public-api" title="Permalink to this headline">¶</a></h1>
<p>This section describes the public API of the library. The provided types and
functions are used by other applications to create Tic Tac Toe games. The legend
shown in <a class="reference internal" href="#uml-public-api-diagram-legend"><span class="std std-numref">Figure 4.1</span></a> is used for the type diagrams
in this section.</p>
<div class="figure align-default" id="id6">
<span id="uml-public-api-diagram-legend"></span><p class="plantuml">
<img src="../_images/plantuml-00bc1a3458499a6140367b06be9ec5cb0a3af016.svg" alt="hide members

package Module {

}
interface Trait
class Struct {
    +field
    +method()
}

enum Enum {
    EnumVariant
}

show Struct members
show Enum fields"/></p>
<p class="caption"><span class="caption-number">Figure 4.1 </span><span class="caption-text">Legend used for the type diagrams in this section.</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
<p>An overview of the major public types is shown in <a class="reference internal" href="#uml-public-api-overview"><span class="std std-numref">Figure 4.2</span></a>.</p>
<div class="figure align-default" id="id7">
<span id="uml-public-api-overview"></span><p class="plantuml">
<img src="../_images/plantuml-5f7c392386e284f1496e57fe2fbdee2b0f7c521a.svg" alt="hide members

package tic_tac_toe {
    enum Owner
    enum GameState

    Game o-- Board
    Game o- GameState

    Board &quot;1&quot; *-- &quot;n&quot; Square
    Square o- Owner
    AIMove .&gt; Game
}"/></p>
<p class="caption"><span class="caption-number">Figure 4.2 </span><span class="caption-text">Major public modules, structures, and other types. Note: the
module contains additional supporting types.</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
<p>The library contains a single public module that holds the public types. The
naming conventions used in this library follow those described in the Rust API
Guidelines <a class="footnote-reference brackets" href="#rustapiguidelines" id="id1">1</a> per the <a class="reference internal" href="../requirements/user-stories.html#ref-idiomatic-rust-apis-story"><span class="std std-ref">Idiomatic Rust APIs</span></a>
user story.</p>
<p>Each of the major and supporting types are described below.</p>
<div class="section" id="game-management">
<h2>4.1.1. Game Management<a class="headerlink" href="#game-management" title="Permalink to this headline">¶</a></h2>
<p>Game management is handled by the Game structure. This structure is one of the
central types provided by the crate. It contains the state machine logic and
holds the underlying game board.
<a class="reference internal" href="#uml-game-management"><span class="std std-numref">Figure 4.3</span></a> shows the Game structure along with the GameState
enumeration.</p>
<div class="figure align-default" id="id8">
<span id="uml-game-management"></span><p class="plantuml">
<img src="../_images/plantuml-7c87539368cb8db028298b06f319d1276d9ad336.svg" alt="hide empty fields

class Game {
    +new()
    +board() -&gt; Board
    +state() -&gt; GameState
    +can_move(position) -&gt; bool
    +do_move(position)
    +start_next_game()
}

enum GameState {
    PlayerXMove
    PlayerOMove
    PlayerXWin[VictorySets]
    PlayerOWin[VictorySets]
    CatsGame

    +is_game_over() -&gt; bool
}"/></p>
<p class="caption"><span class="caption-number">Figure 4.3 </span><span class="caption-text">The Game structure and GameState enumeration.</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
<p>A state machine to determine which player has the next move or when the game
is over. The state diagram is shown in <a class="reference internal" href="#uml-game-state-diagram"><span class="std std-numref">Figure 4.4</span></a>.</p>
<div class="figure align-default" id="id9">
<span id="uml-game-state-diagram"></span><p class="plantuml">
<img src="../_images/plantuml-54833c3598e19d85d75d20dd988336c5557b179e.svg" alt="hide empty description

[*] --&gt; PlayerXMove
[*] --&gt; PlayerOMove

PlayerXMove --&gt; PlayerOMove
PlayerXMove --&gt; PlayerXWin
PlayerXMove --&gt; CatsGame

PlayerOMove --&gt; PlayerXMove
PlayerOMove --&gt; PlayerOWin
PlayerOMove --&gt; CatsGame"/></p>
<p class="caption"><span class="caption-number">Figure 4.4 </span><span class="caption-text">State diagram of a Tic Tac Toe game.</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
<p>When a new game starts either player X or player O takes the first turn.
The players alternate making their moves until one of the end game conditions is
encountered. The player that did not have the first turn last game takes the
first turn next game.</p>
<div class="section" id="struct-game">
<h3>4.1.1.1. Struct Game<a class="headerlink" href="#struct-game" title="Permalink to this headline">¶</a></h3>
<p>Members of the Game structure are as follows:</p>
<dl class="simple">
<dt>new()</dt><dd><p>Creates a new Tic Tac Toe game.</p>
</dd>
<dt>board()</dt><dd><p>Gets the board associated with the game.</p>
</dd>
<dt>state()</dt><dd><p>Gets the current state of the game.</p>
</dd>
<dt>can_move()</dt><dd><p>Indicates if the square at the indicated position can be marked as owned.
That is, if <code class="docutils literal notranslate"><span class="pre">can_move()</span></code> returns <code class="docutils literal notranslate"><span class="pre">true</span></code> then <code class="docutils literal notranslate"><span class="pre">do_move()</span></code> is guaranteed
to not panic.</p>
</dd>
<dt>do_move()</dt><dd><p>Marks the indicated square as being owned by the current player. The state
of the game is updated as a side effect of <code class="docutils literal notranslate"><span class="pre">do_move()</span></code>.
Panics if the indicated position is already owned or if the game is over.</p>
</dd>
<dt>start_next_game()</dt><dd><p>Starts the next game by resetting the state machine ensuring the player who
went second last game goes first next game.</p>
</dd>
</dl>
<p class="rubric">Trait Implementations</p>
<ul class="simple">
<li><p>Clone <a class="footnote-reference brackets" href="#clonecopy" id="id2">2</a></p></li>
</ul>
<p class="rubric">Related Requirements</p>
<ul class="simple">
<li><p><a class="reference internal" href="../requirements/ttt-rules.html"><span class="doc">Rules of Tic Tac Toe</span></a></p></li>
<li><p><a class="reference internal" href="../requirements/user-stories.html#ref-game-state-management-story"><span class="std std-ref">Game State Management</span></a></p></li>
<li><p><a class="reference internal" href="../requirements/user-stories.html#ref-players-take-turns-having-first-move-story"><span class="std std-ref">Players Take Turns Having the First Move</span></a></p></li>
</ul>
</div>
<div class="section" id="enum-gamesate">
<h3>4.1.1.2. Enum GameSate<a class="headerlink" href="#enum-gamesate" title="Permalink to this headline">¶</a></h3>
<p>The game state enumeration contains a variant for each possible game state
described in <a class="reference internal" href="#uml-game-state-diagram"><span class="std std-numref">Figure 4.4</span></a> along with some additional helper
methods.</p>
<dl class="simple">
<dt>PlayerXMove</dt><dd><p>Player X’s turn to mark an empty square.</p>
</dd>
<dt>PlayerOMove</dt><dd><p>Player O’s turn to mark an empty square.</p>
</dd>
<dt>PlayerXWin[VictorySets]</dt><dd><p>Player X has won the game. The victory sets that contributed to the win are
provided as the enum value.</p>
</dd>
<dt>PlayerOWin[VictorySets]</dt><dd><p>Player O has won the game. The victory sets that contributed to the win are
provided as the enum value.</p>
</dd>
<dt>CatsGame</dt><dd><p>The game has ended in a draw where there are no winners.</p>
</dd>
<dt>is_game_over()</dt><dd><p>Indicates if the state represents one of the game over states. That is,
if either player has won or it is a cat’s game true is returned; otherwise,
false is returned.</p>
</dd>
</dl>
<p class="rubric">Trait Implementations</p>
<ul class="simple">
<li><p>Copy</p></li>
<li><p>Eq</p></li>
<li><p>Debug</p></li>
</ul>
<p class="rubric">Related Requirements</p>
<ul class="simple">
<li><p><a class="reference internal" href="../requirements/user-stories.html#ref-know-victory-squares-story"><span class="std std-ref">Know Cells that Contributed to Player’s Victory</span></a></p></li>
</ul>
</div>
</div>
<div class="section" id="board-data">
<h2>4.1.2. Board Data<a class="headerlink" href="#board-data" title="Permalink to this headline">¶</a></h2>
<p>The board structure models a Tic Tac Toe game board. It holds the individual
squares of the board and provides functions to access and iterate over the
squares. The board and square structures along with supporting types are shown
in <a class="reference internal" href="#uml-struct-board"><span class="std std-numref">Figure 4.5</span></a>.</p>
<div class="figure align-default" id="id10">
<span id="uml-struct-board"></span><p class="plantuml">
<img src="../_images/plantuml-cfbd9bf53441b346430e7d6ae65a828547cedde2.svg" alt="hide empty fields
hide empty methods

class Board {
    +new()
    +size() -&gt; i32
    +get(position) -&gt; Square
    +get_mut(position) -&gt; Square
    +iter() -&gt; Iter
    +free_squares() -&gt; FreeSquares
    +victory_sets() -&gt; VictorySets
}

interface std::iter::Iterator {
    +Item: type
    +next() -&gt; Option&lt;Item&gt;
}

class Iter {
    +Item: Square
}
std::iter::Iterator &lt;|-- Iter

class FreeSquares {
    +Item: Square
}
std::iter::Iterator &lt;|-- FreeSquares

class VictorySets {
    +Item: slice&lt;Square&gt;
}
std::iter::Iterator &lt;|-- VictorySets

class Square {
    +position: Position
    +owner: Owner
}

class Position {
    +row: i32
    +column: i32
}

enum Owner {
    PlayerX
    PlayerO
    None
}

' Hidden links are used to help with the diagram's layout.
Board -[hidden] std::iter::Iterator
VictorySets -[hidden]- Owner
Square -[hidden] Position
Position -[hidden] Owner"/></p>
<p class="caption"><span class="caption-number">Figure 4.5 </span><span class="caption-text">The Board structure and supporting types.</span><a class="headerlink" href="#id10" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="struct-board">
<h3>4.1.2.1. Struct Board<a class="headerlink" href="#struct-board" title="Permalink to this headline">¶</a></h3>
<p>Data structure representing the Tic Tac Toe board. Provides multiple ways to
access individual squares.</p>
<dl class="simple">
<dt>new()</dt><dd><p>Constructs a new board.</p>
</dd>
<dt>size()</dt><dd><p>Gets the size of board, that is the number of rows and columns.
Note: boards are always square.</p>
</dd>
<dt>get()</dt><dd><p>Gets the square at the indicated position. Panics if requested position is
outside the size of the board.</p>
</dd>
<dt>get_mut()</dt><dd><p>Gets a mutable square at the indicated position. Panics under the same
situations as get().</p>
</dd>
<dt>iter()</dt><dd><p>Gets an iterator that iterates over all the squares in the board.</p>
</dd>
<dt>free_squares()</dt><dd><p>Gets an iterator that iterates the squares in the board that do not have an
owner.</p>
</dd>
<dt>victory_sets()</dt><dd><p>Gets an iterator that iterates over all the sets of squares that, if all
owned by a player, would make the player victorious. E.g. this gets all the
rows, columns, and both diagonals as slices.</p>
</dd>
</dl>
<p>The board structure also implements the Display trait. This provides a formatted
output of the board and is suitable for use in simple console applications or
debugging purposes. An example of the boards display is shown in
<a class="reference internal" href="#code-example-board-display"><span class="std std-numref">Listing 4.1</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="id11">
<span id="code-example-board-display"></span><div class="code-block-caption"><span class="caption-number">Listing 4.1 </span><span class="caption-text">Example board display output.</span><a class="headerlink" href="#id11" title="Permalink to this code">¶</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>+---+---+---+
| X | O | O |
+---+---+---+
| O | X |   |
+---+---+---+
| X |   | X |
+---+---+---+
</pre></div>
</div>
</div>
<p class="rubric">Trait Implementations</p>
<ul class="simple">
<li><p>Display</p></li>
<li><p>Clone</p></li>
</ul>
</div>
<div class="section" id="struct-square">
<h3>4.1.2.2. Struct Square<a class="headerlink" href="#struct-square" title="Permalink to this headline">¶</a></h3>
<p>Represents an individual square of the game board.</p>
<dl class="simple">
<dt>position</dt><dd><p>The position the square is located at on the board.</p>
</dd>
<dt>owner</dt><dd><p>The owner of the square.</p>
</dd>
</dl>
<p class="rubric">Trait Implementations</p>
<ul class="simple">
<li><p>Debug</p></li>
<li><p>Clone</p></li>
<li><p>Copy</p></li>
<li><p>Eq</p></li>
</ul>
</div>
<div class="section" id="struct-position">
<h3>4.1.2.3. Struct Position<a class="headerlink" href="#struct-position" title="Permalink to this headline">¶</a></h3>
<p>The position structure represents a specific board position denoted by row and
column.</p>
<dl class="simple">
<dt>row</dt><dd><p>The row associated with the position.</p>
</dd>
<dt>column</dt><dd><p>The column associated with the position.</p>
</dd>
</dl>
<p class="rubric">Trait Implementations</p>
<ul class="simple">
<li><p>Debug</p></li>
<li><p>Copy</p></li>
<li><p>Clone</p></li>
<li><p>From&lt;(i32, i32)&gt;</p></li>
<li><p>Eq</p></li>
<li><p>Hash</p></li>
</ul>
</div>
<div class="section" id="enum-owner">
<h3>4.1.2.4. Enum Owner<a class="headerlink" href="#enum-owner" title="Permalink to this headline">¶</a></h3>
<p>The owner enumeration indicates which player owns a square, if any.</p>
<dl class="simple">
<dt>PlayerX</dt><dd><p>Player X owns the square.</p>
</dd>
<dt>PlayerO</dt><dd><p>Player O owns the square.</p>
</dd>
<dt>None</dt><dd><p>No player owns the square.</p>
</dd>
</dl>
<p class="rubric">Trait Implementations</p>
<ul class="simple">
<li><p>Debug</p></li>
<li><p>Copy</p></li>
<li><p>Clone</p></li>
<li><p>Eq</p></li>
</ul>
</div>
<div class="section" id="iterating-over-squares">
<h3>4.1.2.5. Iterating Over Squares<a class="headerlink" href="#iterating-over-squares" title="Permalink to this headline">¶</a></h3>
<p>The board structure provides several ways to iterate over board’s squares. <a class="footnote-reference brackets" href="#iterators" id="id3">3</a>
Helper types that implement the Iterator trait are used to provide this support.</p>
<dl class="simple">
<dt>Iter</dt><dd><p>Iterates over all the squares in the board.</p>
</dd>
<dt>FreeSquares</dt><dd><p>Iterates over squares that do not have an owner.</p>
</dd>
<dt>VictorySets</dt><dd><p>Iterates over all the sets of squares that, if all owned by a player, would
make the player victorious.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="ai-moves">
<h2>4.1.3. AI Moves<a class="headerlink" href="#ai-moves" title="Permalink to this headline">¶</a></h2>
<p>The AI move structure represents a move by an AI player. The AI move structure is
shown in <a class="reference internal" href="#uml-struct-ai-move"><span class="std std-numref">Figure 4.6</span></a>.</p>
<div class="figure align-default" id="id12">
<span id="uml-struct-ai-move"></span><p class="plantuml">
<img src="../_images/plantuml-589eb37676a3e003d515cbbd37579a04195ff6ff.svg" alt="hide empty fields

class AIMove {
    +new(game, mistake_probability)
    +position() -&gt; Position
}"/></p>
<p class="caption"><span class="caption-number">Figure 4.6 </span><span class="caption-text">AI Move structure.</span><a class="headerlink" href="#id12" title="Permalink to this image">¶</a></p>
</div>
<p>See <a class="reference internal" href="ai-algorithms.html"><span class="doc">Artificial Intelligence Algorithms</span></a> for details on how the AI selects a position.</p>
<p class="rubric">Member Details</p>
<dl class="simple">
<dt>new()</dt><dd><p>Constructs a new AI move using the provided game and a given probability of
making a mistake. Panics if the game is over.</p>
</dd>
<dt>position()</dt><dd><p>Gets the position selected by the AI player based on the previously provided
game.</p>
</dd>
</dl>
<p class="rubric">Trait Implementations</p>
<ul class="simple">
<li><p>Debug</p></li>
</ul>
<p class="rubric">Related Requirements</p>
<ul class="simple">
<li><p><a class="reference internal" href="../requirements/user-stories.html#ref-ai-player-story"><span class="std std-ref">AI Player</span></a></p></li>
<li><p><a class="reference internal" href="../requirements/user-stories.html#ref-ai-difficulty-settings-story"><span class="std std-ref">AI Difficulty Settings</span></a></p></li>
</ul>
<p class="rubric">Footnotes</p>
<dl class="footnote brackets">
<dt class="label" id="rustapiguidelines"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>See the <a class="reference internal" href="../references.html#rust-api-guidelines" id="id4"><span>[Rust-API-Guidelines]</span></a> for details.</p>
</dd>
<dt class="label" id="clonecopy"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Rust’s clone and copy traits both serve to duplicate an object but
each goes about duplication in a different manner. Copy performs an operation
similar to <cite>memcpy</cite> where it just copies the bits of the object. Alternately,
Clone explicitly duplicates the object giving the programmer control over
what parts are cloned. For details see the discussion in
<a class="reference external" href="https://doc.rust-lang.org/std/clone/trait.Clone.html">Trait std::clone::Clone</a>.</p>
</dd>
<dt class="label" id="iterators"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>Rust’s standard library documentation states “Iterators are
heavily used in idiomatic Rust code, so it’s worth becoming familiar
with them.” For details see <a class="reference internal" href="../references.html#rust-crate-std" id="id5"><span>[Rust-Crate-std]</span></a>.</p>
</dd>
</dl>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Ounce of Rust Project Design Document</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/index.html">2. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../requirements/index.html">3. Requirements</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">4. Design</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">4.1. Public API</a></li>
<li class="toctree-l2"><a class="reference internal" href="ai-algorithms.html">4.2. Artificial Intelligence Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="other-considerations.html">4.3. Other Considerations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">5. Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">6. References</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="singlepage.html">View Single Page</a></li>
    
    <li class="toctree-l1"><a href="https://github.com/j-richey/ounce-of-rust-design-doc">GitHub Source</a></li>
    
    <li class="toctree-l1"><a href="ounce_of_rust_project_design_document_rev_a_draft_1.pdf">Download PDF</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">4. Design</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">4. Design</a></li>
      <li>Next: <a href="ai-algorithms.html" title="next chapter">4.2. Artificial Intelligence Algorithms</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, James Richey.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/design/public-api.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>