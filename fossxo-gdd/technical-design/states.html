
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>6.2. Game States &#8212; FossXO Game Design Document Rev. B</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6.3. Systems" href="systems.html" />
    <link rel="prev" title="6.1. Engine Overview" href="engine-overview.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="game-states">
<h1><span class="section-number">6.2. </span>Game States<a class="headerlink" href="#game-states" title="Permalink to this headline">¶</a></h1>
<p>A game state is a general and global part of the game. The active state is
updated every game loop, has access to the world’s entities and resources, and
can receive events. States can also request a transition to a different state.</p>
<div class="section" id="state-trait">
<span id="index-0"></span><h2><span class="section-number">6.2.1. </span>State Trait<a class="headerlink" href="#state-trait" title="Permalink to this headline">¶</a></h2>
<p>In Amethyst states implement the <a class="reference external" href="https://docs.amethyst.rs/stable/amethyst/trait.State.html">State trait</a>.
A summary of the State trait is shown in <a class="reference internal" href="#uml-state-trait"><span class="std std-numref">Figure 6.2</span></a>.</p>
<div class="figure align-default" id="id4">
<span id="uml-state-trait"></span><p class="plantuml">
<img src="../_images/plantuml-ecf66c7892ae744bbd72dc1ba037f2ca4ee0adcf.svg" alt="!include rust_types.uml
hide empty members

trait(State) {
    +on_start(StateData)
    +on_stop(StateData)
    +on_pause(StateData)
    +on_resume(StateData)
    +handle_event(StateData, EventData) -&gt; Trans
    +update(StateData) -&gt; Trans
}"/></p>
<p class="caption"><span class="caption-number">Figure 6.2 </span><span class="caption-text">Notable methods provided by the State trait.</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<p>Each method is provided a <code class="docutils literal notranslate"><span class="pre">StateData</span></code> structure that provide’s access to the
world’s entities and resources. Additionally, <code class="docutils literal notranslate"><span class="pre">handle_event()</span></code> is provided an
<code class="docutils literal notranslate"><span class="pre">EventData</span></code> enum, shown in <a class="reference internal" href="#uml-event-data-enum"><span class="std std-numref">Figure 6.3</span></a>, that aggregates the
different types of events available to the states.</p>
<div class="figure align-default" id="id5">
<span id="uml-event-data-enum"></span><p class="plantuml">
<img src="../_images/plantuml-0ff48b9bf9afb9d22af501cc40f6e8e8abf45520.svg" alt="!include rust_types.uml
hide empty members

enum(EventData) {
    Window(WindowEvent)
    Ui(UiEvent)
    Input(InputEvent)
    Player(PlayerEvent)
}"/></p>
<p class="caption"><span class="caption-number">Figure 6.3 </span><span class="caption-text">Event data available to states.</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<p>The window, UI, and input events are generated by various Amethyst subsystems.
The remaining variants hold custom events generated by the game that states wish
wish to receive.</p>
</div>
<div class="section" id="state-diagram">
<h2><span class="section-number">6.2.2. </span>State Diagram<a class="headerlink" href="#state-diagram" title="Permalink to this headline">¶</a></h2>
<p>The state diagram in <a class="reference internal" href="#uml-game-state-diagram"><span class="std std-numref">Figure 6.4</span></a> shows each state and their
state transitions. <a class="footnote-reference brackets" href="#screenflowchart" id="id1">1</a></p>
<div class="figure align-default" id="id6">
<span id="uml-game-state-diagram"></span><p class="plantuml">
<img src="../_images/plantuml-42aa880b075dbdc3fa4432233e87aa80136de062.svg" alt="hide empty description

[*] --&gt; Loading
Loading --&gt; Game
Game --&gt; MainMenu

MainMenu --&gt; Game
MainMenu --&gt; SinglePlayerMenu
MainMenu --&gt; OptionsMenu
MainMenu --&gt; [*]

OptionsMenu --&gt; MainMenu

SinglePlayerMenu --&gt; Game
SinglePlayerMenu --&gt; SpeedrunMenu
SinglePlayerMenu --&gt; MainMenu

SpeedrunMenu --&gt; SinglePlayerMenu
SpeedrunMenu --&gt; SpeedrunGame
SpeedrunGame --&gt; SpeedrunMenu
SpeedrunMenu --&gt; SpeedrunBestTimeMenu
SpeedrunBestTimeMenu --&gt; SpeedrunMenu"/></p>
<p class="caption"><span class="caption-number">Figure 6.4 </span><span class="caption-text">State diagram for the game states.</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="game-state">
<span id="ref-game-state"></span><span id="index-1"></span><h2><span class="section-number">6.2.3. </span>Game State<a class="headerlink" href="#game-state" title="Permalink to this headline">¶</a></h2>
<p>The game state is used for <a class="reference internal" href="../gameplay.html#ref-gameplay-single-player-mode"><span class="std std-ref">Single-player Mode</span></a> and
<a class="reference internal" href="../gameplay.html#ref-gameplay-two-player-mode"><span class="std std-ref">Two Player Mode</span></a> games. The responsibilities of this state
are:</p>
<ul class="simple">
<li><p>Spawn the player and AI opponent entities for playing the game.</p></li>
<li><p>Handle player events for when marks are placed.</p></li>
<li><p>Manage the game resource.</p></li>
<li><p>Show the game environment with the <a class="reference internal" href="components-resources-entities.html#ref-environments-resource"><span class="std std-ref">Environments Resource</span></a>.</p></li>
<li><p>Show the <a class="reference internal" href="../gui.html#ref-ui-game-board"><span class="std std-ref">Game Board</span></a> widgets including the menu button and
status text.</p></li>
<li><p>Navigate to the main menu state.</p></li>
</ul>
<p>When the game state is started, the options to use are provided. This includes
if the game is single-player or multiplayer. For single-player, this is the
difficulty level and if the player is using X or O marks.</p>
</div>
<div class="section" id="speedrun-game-state">
<span id="ref-speedrun-game-state"></span><span id="index-2"></span><h2><span class="section-number">6.2.4. </span>Speedrun Game State<a class="headerlink" href="#speedrun-game-state" title="Permalink to this headline">¶</a></h2>
<p>The speedrun game state is used for <a class="reference internal" href="../gameplay.html#ref-gameplay-speed-run-mode"><span class="std std-ref">Speedrun Mode</span></a> games.
<a class="footnote-reference brackets" href="#speedrunstatedifference" id="id2">2</a> The responsibilities of this state are:</p>
<ul class="simple">
<li><p>Spawn the player and AI opponent entities for playing the game.</p></li>
<li><p>Handle player events for when marks are placed.</p></li>
<li><p>Manage the game resource.</p></li>
<li><p>Keep track of the total speedrun time and time for each game.</p></li>
<li><p>Show the <a class="reference internal" href="../gui.html#ref-ui-speedrun-game-board"><span class="std std-ref">Speedrun</span></a> widgets including the menu
button and status text.</p></li>
<li><p>Navigate to the best time menu state providing the results of the speedrun.
The results include a successful game along with the run’s time, a
lost game, or an aborted game from the player opening the menu.</p></li>
</ul>
</div>
<div class="section" id="loading-state">
<span id="index-3"></span><h2><span class="section-number">6.2.5. </span>Loading State<a class="headerlink" href="#loading-state" title="Permalink to this headline">¶</a></h2>
<p>The loading state is the first state run when the game starts. The
responsibilities are:</p>
<ul class="simple">
<li><p>Show the <a class="reference internal" href="../gui.html#ref-ui-loading-screen"><span class="std std-ref">Loading Screen</span></a> widgets.</p></li>
<li><p>Queue the resources to load with asset loader.</p></li>
<li><p>Monitor and optionally report the loading progress.</p></li>
<li><p>Launch the game state when resource loading is complete. The
single player game options last used are provided. <a class="footnote-reference brackets" href="#firstgamesettings" id="id3">3</a></p></li>
</ul>
<p>The loading state asks the <a class="reference internal" href="components-resources-entities.html#ref-environments-resource"><span class="std std-ref">Environments Resource</span></a> and any other
resources to queue the assets that need loaded. It then monitors the loading
progress and transitions to the game state when complete.</p>
</div>
<div class="section" id="main-menu-state">
<span id="ref-main-menu-state"></span><span id="index-4"></span><h2><span class="section-number">6.2.6. </span>Main Menu State<a class="headerlink" href="#main-menu-state" title="Permalink to this headline">¶</a></h2>
<p>The main menu state allows uses to navigate to the other states.
Responsibilities include:</p>
<ul class="simple">
<li><p>Show the <a class="reference internal" href="../gui.html#ref-ui-main-menu"><span class="std std-ref">Main Menu</span></a> widgets.</p></li>
<li><p>Navigate to the single-player menu state.</p></li>
<li><p>Launch the game state with the multiplayer game flag.</p></li>
<li><p>Navigate to the options menu state.</p></li>
<li><p>Navigate to the credits menu state.</p></li>
<li><p>Open the game’s user manual in an external browser.</p></li>
<li><p>Go to the quit state to exit the game.</p></li>
</ul>
</div>
<div class="section" id="single-player-menu-state">
<span id="ref-single-player-menu-state"></span><span id="index-5"></span><h2><span class="section-number">6.2.7. </span>Single-player Menu State<a class="headerlink" href="#single-player-menu-state" title="Permalink to this headline">¶</a></h2>
<p>The single-player menu state shows the UI for configuring single-player games.
The responsibilities are:</p>
<ul class="simple">
<li><p>Show the <a class="reference internal" href="../gui.html#ref-ui-single-player"><span class="std std-ref">Single-player</span></a> menu widgets.</p></li>
<li><p>Launch the <a class="reference internal" href="#ref-game-state"><span class="std std-ref">Game State</span></a> providing the single-player options
selected by the player.</p></li>
<li><p>Navigate to the <a class="reference internal" href="#ref-speedrun-menu-state"><span class="std std-ref">Speedrun Menu State</span></a> providing the player mark option.</p></li>
<li><p>Go back to the <a class="reference internal" href="#ref-main-menu-state"><span class="std std-ref">Main Menu State</span></a>.</p></li>
</ul>
</div>
<div class="section" id="speedrun-menu-state">
<span id="ref-speedrun-menu-state"></span><span id="index-6"></span><h2><span class="section-number">6.2.8. </span>Speedrun Menu State<a class="headerlink" href="#speedrun-menu-state" title="Permalink to this headline">¶</a></h2>
<p>The speedrun menu state is the entry point to speed run games. The
responsibilities are:</p>
<ul class="simple">
<li><p>Show the <a class="reference internal" href="../gui.html#ref-ui-speedrun"><span class="std std-ref">Speedrun</span></a> menu widgets.</p></li>
<li><p>Query best speed run times from the <a class="reference internal" href="file-formats.html#ref-user-data-file"><span class="std std-ref">User Data File</span></a>.</p></li>
<li><p>Launch the speedrun game state using the the player mark option.</p></li>
<li><p>Go to the best time menu state if the user got a best time. The user’s time
and other speedrun information is provided.</p></li>
<li><p>Go back to the single-player menu state.</p></li>
</ul>
<p>When the speedrun menu state is started, it is optionally provided the result of
the speedrun game. It uses this information to know if it should show the
instructional text, show the game results, or navigate to the best time menu.</p>
</div>
<div class="section" id="speedrun-best-time-menu-state">
<span id="ref-speedrun-best-time-menu-state"></span><span id="index-7"></span><h2><span class="section-number">6.2.9. </span>Speedrun Best Time Menu State<a class="headerlink" href="#speedrun-best-time-menu-state" title="Permalink to this headline">¶</a></h2>
<p>The speedrun best time menu state allows users to view and record a best
speedrun time. The responsibilities are:</p>
<ul class="simple">
<li><p>Show the speed run best time dialog widgets described in the
<a class="reference internal" href="../gui.html#ref-ui-speedrun"><span class="std std-ref">Speedrun</span></a> menu.</p></li>
<li><p>Save the best time information to the <a class="reference internal" href="file-formats.html#ref-user-data-file"><span class="std std-ref">User Data File</span></a>.</p></li>
<li><p>Navigate to the speedrun menu state.</p></li>
</ul>
</div>
<div class="section" id="credits-menu-state">
<span id="ref-credits-menu-state"></span><span id="index-8"></span><h2><span class="section-number">6.2.10. </span>Credits Menu State<a class="headerlink" href="#credits-menu-state" title="Permalink to this headline">¶</a></h2>
<p>The credits menu state shows the game’s credits along with demoing the various
games environments. The responsibilities are:</p>
<ul class="simple">
<li><p>Show the <a class="reference internal" href="../gui.html#ref-ui-credits"><span class="std std-ref">Credits</span></a> menu widgets.</p></li>
<li><p>Open the game’s licence compliance information contained in the user manual
in an external browser.</p></li>
<li><p>Show different in progress games.</p></li>
<li><p>Go back to the main menu state.</p></li>
</ul>
<p>The credits menu demonstrates the various game environments. It does this by
creating two AI players that battle while occasionally switching the current
environment using the ref:<cite>ref-environments-resource</cite>.</p>
</div>
<div class="section" id="options-menu-state">
<span id="ref-options-menu-state"></span><span id="index-9"></span><h2><span class="section-number">6.2.11. </span>Options Menu State<a class="headerlink" href="#options-menu-state" title="Permalink to this headline">¶</a></h2>
<p>The options menu state shows the various options related widgets and saves the
games options. Its responsibilities are:</p>
<ul class="simple">
<li><p>Show the <a class="reference internal" href="../gui.html#ref-ui-options"><span class="std std-ref">Options</span></a> menu widgets.</p></li>
<li><p>Apply the user provided options and save the
<a class="reference internal" href="file-formats.html#ref-game-configuration-file"><span class="std std-ref">Game Configuration File</span></a> to disk.</p></li>
<li><p>Allow resetting options to default values.</p></li>
<li><p>Go back to the main menu state.</p></li>
</ul>
<p class="rubric">Footnotes</p>
<dl class="footnote brackets">
<dt class="label" id="screenflowchart"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>The game state diagram is similar, but not identical, to
the <a class="reference internal" href="../gui.html#ref-ui-screen-flowchart"><span class="std std-ref">Screen Flowchart</span></a> shown in <a class="reference internal" href="../gui.html#uml-screen-flowchart"><span class="std std-numref">Figure 3.10</span></a>.
Some notable differences include how the speedrun game state always
transitions back to the speedrun menu state.</p>
</dd>
<dt class="label" id="speedrunstatedifference"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>At first glance the speedrun game state has
similar responsibilities the game state. However, the speedrun games use
different rules, show additional widgets, and transition to different
states. Thus it this mode gets its own state.</p>
</dd>
<dt class="label" id="firstgamesettings"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>The <a class="reference internal" href="../gui.html#ref-ui-game-board"><span class="std std-ref">Game Board</span></a> section further describes
the behavior of the game when first started.</p>
</dd>
</dl>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">FossXO Game Design Document</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gameplay.html">2. Gameplay</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gui.html">3. User Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../environments.html">4. Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/index.html">5. Additional Considerations</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">6. Technical Design</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="engine-overview.html">6.1. Engine Overview</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">6.2. Game States</a></li>
<li class="toctree-l2"><a class="reference internal" href="systems.html">6.3. Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="components-resources-entities.html">6.4. Components, Resources, and Entities</a></li>
<li class="toctree-l2"><a class="reference internal" href="file-formats.html">6.5. File Formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="user-manual.html">6.6. User Manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="packaging.html">6.7. Packages and Source Builds</a></li>
<li class="toctree-l2"><a class="reference internal" href="security.html">6.8. System Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="development-tools.html">6.9. Development Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="prototype.html">6.10. Throwaway Prototype Lessons</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">7. Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">8. References</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="https://github.com/j-richey/fossxo-gdd">GitHub Source</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html"><span class="section-number">6. </span>Technical Design</a><ul>
      <li>Previous: <a href="engine-overview.html" title="previous chapter"><span class="section-number">6.1. </span>Engine Overview</a></li>
      <li>Next: <a href="systems.html" title="next chapter"><span class="section-number">6.3. </span>Systems</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, James Richey.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/technical-design/states.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>